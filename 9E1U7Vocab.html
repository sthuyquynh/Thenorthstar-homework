<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive English Exercise & Dictionary</title>
    <style>
        :root {
            --correct: #2ecc71;
            --wrong: #e74c3c;
            --primary: #3498db;
            --accent: #f39c12;
        }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; line-height: 1.6; max-width: 900px; margin: 20px auto; padding: 20px; background-color: #f0f2f5; }
        .container { background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); position: relative; }
        
        /* Thông tin học sinh */
        .header-info { background: #e8f1f8; padding: 15px; border-radius: 8px; margin-bottom: 25px; }
        #studentName { width: 100%; padding: 10px; margin-top: 10px; border: 1px solid #ccc; border-radius: 4px; font-size: 16px; box-sizing: border-box; }

        h2 { color: #2c3e50; border-left: 5px solid var(--primary); padding-left: 10px; margin-top: 40px; }
        
        /* Kéo thả */
        .word-box { background: #f9f9f9; padding: 15px; border: 2px dashed #3498db; border-radius: 8px; display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 20px; }
        .draggable { background: white; border: 1px solid #3498db; padding: 5px 12px; border-radius: 20px; cursor: move; color: #2980b9; font-weight: 500; }
        .drop-zone { display: inline-block; width: 140px; border-bottom: 2px solid #999; text-align: center; font-weight: bold; color: var(--primary); min-height: 25px; vertical-align: middle; }
        
        /* Trắc nghiệm */
        .question-block { margin-bottom: 20px; padding: 15px; background: #fff; border: 1px solid #eee; border-radius: 8px; }
        .options { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px; }
        .option-item { padding: 10px; border: 1px solid #ddd; border-radius: 6px; cursor: pointer; transition: 0.2s; }
        .option-item:hover { background: #f0f7ff; }
        .option-item.selected { background: #d6eaf8; border-color: #3498db; }
        
        /* Nút từ điển bám dính */
        #dict-toggle { position: fixed; right: 0; top: 50%; transform: translateY(-50%); background: var(--accent); color: white; padding: 15px 10px; cursor: pointer; border-radius: 10px 0 0 10px; writing-mode: vertical-rl; text-orientation: mixed; font-weight: bold; z-index: 1000; box-shadow: -2px 0 5px rgba(0,0,0,0.2); }
        #dictionary-panel { position: fixed; right: -350px; top: 0; width: 320px; height: 100%; background: white; box-shadow: -5px 0 15px rgba(0,0,0,0.1); z-index: 1001; transition: 0.3s; padding: 20px; overflow-y: auto; }
        #dictionary-panel.open { right: 0; }
        .dict-search { width: 100%; padding: 8px; margin-bottom: 15px; border: 1px solid #ddd; border-radius: 4px; }
        .dict-item { border-bottom: 1px solid #eee; padding: 5px 0; font-size: 14px; }
        .dict-word { color: var(--primary); font-weight: bold; }

        /* Kết quả */
        .feedback { display: none; margin-top: 10px; font-size: 0.9em; font-style: italic; color: #666; background: #fff9c4; padding: 8px; border-radius: 4px; }
        .correct-ans { background-color: #e8f5e9 !important; border-color: var(--correct) !important; color: #2e7d32; }
        .wrong-ans { background-color: #ffebee !important; border-color: var(--wrong) !important; color: #c62828; }

        #submit-btn { display: block; width: 100%; padding: 18px; background: #2c3e50; color: white; border: none; border-radius: 8px; font-size: 18px; cursor: pointer; margin: 40px 0; }
        #submit-btn:hover { background: #1a252f; }

        /* Icon giáo viên */
        #teacher-icon { position: fixed; bottom: 10px; right: 10px; opacity: 0.1; cursor: pointer; font-size: 12px; }
        #teacher-icon:hover { opacity: 1; }
        #admin-panel { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 25px; border-radius: 10px; box-shadow: 0 0 20px rgba(0,0,0,0.5); z-index: 2000; width: 80%; max-height: 80vh; overflow-y: auto; }
    </style>
</head>
<body>

<div id="dict-toggle" onclick="toggleDict()">TỪ ĐIỂN TRA CỨU</div>
<div id="dictionary-panel" id="dictPanel">
    <h3>Từ điển bài học</h3>
    <input type="text" class="dict-search" id="dictSearch" placeholder="Tìm từ..." onkeyup="searchDict()">
    <div id="dictList"></div>
    <button onclick="toggleDict()" style="width:100%; margin-top:20px;">Đóng</button>
</div>

<div class="container">
    <h1>BÀI TẬP TIẾNG ANH TỔNG HỢP</h1>
    
    <div class="header-info">
        <label><b>Họ và tên học sinh:</b></label>
        <input type="text" id="studentName" placeholder="Nhập tên của em...">
    </div>

    <section>
        <h2>BÀI 1: Điền từ vào chỗ trống</h2>
        <div class="word-box" id="wb1">
            <div class="draggable" draggable="true">natural wonder</div>
            <div class="draggable" draggable="true">explore</div>
            <div class="draggable" draggable="true">exploration</div>
            <div class="draggable" draggable="true">landscape</div>
            <div class="draggable" draggable="true">charming</div>
            <div class="draggable" draggable="true">wonder</div>
            <div class="draggable" draggable="true">wonderful</div>
            <div class="draggable" draggable="true">peak</div>
            <div class="draggable" draggable="true">valley</div>
            <div class="draggable" draggable="true">magnificent</div>
        </div>
        <div class="sentences">
            <p>1. Ha Long Bay is a famous <span class="drop-zone" data-ans="natural wonder"></span> recognized by UNESCO.</p>
            <p>2. Tourists love to <span class="drop-zone" data-ans="explore"></span> the caves by boat.</p>
            <p>3. The <span class="drop-zone" data-ans="exploration"></span> of the Himalayas is extremely challenging.</p>
            <p>4. The mountain <span class="drop-zone" data-ans="peak"></span> looks stunning at sunrise.</p>
            <p>5. The small village lies peacefully in a green <span class="drop-zone" data-ans="valley"></span>.</p>
            <p>6. It was a <span class="drop-zone" data-ans="wonderful"></span> experience to see the northern lights.</p>
            <p>7. Scientists have carried out an <span class="drop-zone" data-ans="exploration"></span> of the deep ocean.</p>
            <p>8. The old town is very <span class="drop-zone" data-ans="charming"></span> and attracts many visitors.</p>
            <p>9. The <span class="drop-zone" data-ans="magnificent"></span> view from the top of the mountain amazed everyone.</p>
            <p>10. The children looked at the waterfall in <span class="drop-zone" data-ans="wonder"></span>.</p>
        </div>
    </section>

    <section>
        <h2>BÀI 2: Môi trường & Phát triển</h2>
        <div class="word-box">
            <div class="draggable" draggable="true">developing</div>
            <div class="draggable" draggable="true">development</div>
            <div class="draggable" draggable="true">destroy</div>
            <div class="draggable" draggable="true">destruction</div>
            <div class="draggable" draggable="true">sustainable</div>
            <div class="draggable" draggable="true">protect</div>
            <div class="draggable" draggable="true">protection</div>
            <div class="draggable" draggable="true">environmentalist</div>
            <div class="draggable" draggable="true">develop</div>
            <div class="draggable" draggable="true">environment</div>
        </div>
        <div class="sentences">
            <p>1. Many <span class="drop-zone" data-ans="developing"></span> countries face serious environmental challenges.</p>
            <p>2. Economic <span class="drop-zone" data-ans="development"></span> should not harm nature.</p>
            <p>3. Illegal logging can <span class="drop-zone" data-ans="destroy"></span> large areas of rainforest.</p>
            <p>4. The war caused widespread <span class="drop-zone" data-ans="destruction"></span> of wildlife habitats.</p>
            <p>5. We need <span class="drop-zone" data-ans="sustainable"></span> solutions for tourism and industry.</p>
            <p>6. Everyone should help <span class="drop-zone" data-ans="protect"></span> the natural environment.</p>
            <p>7. The government is responsible for environmental <span class="drop-zone" data-ans="protection"></span>.</p>
            <p>8. An <span class="drop-zone" data-ans="environmentalist"></span> spoke about climate change at the conference.</p>
            <p>9. The factory plans to <span class="drop-zone" data-ans="develop"></span> new eco-friendly technology.</p>
            <p>10. Pollution has a negative impact on the <span class="drop-zone" data-ans="environment"></span>.</p>
        </div>
    </section>

    <section>
        <h2>BÀI 3: Di sản & Quy định</h2>
        <div class="word-box">
            <div class="draggable" draggable="true">discover</div>
            <div class="draggable" draggable="true">discovery</div>
            <div class="draggable" draggable="true">contribute</div>
            <div class="draggable" draggable="true">risky</div>
            <div class="draggable" draggable="true">risk</div>
            <div class="draggable" draggable="true">heritage</div>
            <div class="draggable" draggable="true">permission</div>
            <div class="draggable" draggable="true">paradise</div>
            <div class="draggable" draggable="true">urgent</div>
            <div class="draggable" draggable="true">government</div>
        </div>
        <div class="sentences">
            <p>1. Scientists hope to <span class="drop-zone" data-ans="discover"></span> new species in the rainforest.</p>
            <p>2. The <span class="drop-zone" data-ans="discovery"></span> of ancient ruins attracted global attention.</p>
            <p>3. Everyone can <span class="drop-zone" data-ans="contribute"></span> to protecting nature.</p>
            <p>4. Climbing the mountain without a guide is very <span class="drop-zone" data-ans="risky"></span>.</p>
            <p>5. There is always a <span class="drop-zone" data-ans="risk"></span> when traveling in extreme weather.</p>
            <p>6. The old city is an important cultural <span class="drop-zone" data-ans="heritage"></span>.</p>
            <p>7. Visitors must get <span class="drop-zone" data-ans="permission"></span> before entering the restricted area.</p>
            <p>8. Many people consider the island a tropical <span class="drop-zone" data-ans="paradise"></span>.</p>
            <p>9. Climate change is an <span class="drop-zone" data-ans="urgent"></span> problem that needs action now.</p>
            <p>10. The <span class="drop-zone" data-ans="government"></span> has introduced new laws to protect national parks.</p>
        </div>
    </section>

    <section id="exercise4">
        <h2>BÀI 4: Chọn đáp án đúng nhất</h2>
        <div id="mcContainer"></div>
    </section>

    <button id="submit-btn" onclick="submitQuiz()">CHECK VÀ NỘP BÀI</button>
</div>

<div id="teacher-icon" onclick="toggleAdmin()">⚙️ Admin</div>
<div id="admin-panel">
    <h3>Kết quả học sinh</h3>
    <table border="1" style="width:100%; border-collapse: collapse;">
        <thead><tr><th>Tên</th><th>Điểm</th><th>Thời gian</th></tr></thead>
        <tbody id="adminRecords"></tbody>
    </table>
    <button onclick="toggleAdmin()" style="margin-top:10px;">Đóng</button>
</div>

<script>
    // Dữ liệu từ điển
    const dictionary = [
        {en: "natural wonder", vi: "kỳ quan thiên nhiên"}, {en: "explore", vi: "khám phá"}, {en: "exploration", vi: "sự khám phá"},
        {en: "landscape", vi: "cảnh quan"}, {en: "charming", vi: "quyến rũ"}, {en: "wonder", vi: "sự ngạc nhiên"},
        {en: "wonderful", vi: "tuyệt vời"}, {en: "peak", vi: "đỉnh núi"}, {en: "valley", vi: "thung lũng"},
        {en: "magnificent", vi: "tráng lệ, hùng vĩ"}, {en: "famous", vi: "nổi tiếng"}, {en: "recognize", vi: "công nhận"},
        {en: "UNESCO", vi: "Tổ chức Giáo dục, Khoa học và Văn hóa"}, {en: "tourist", vi: "khách du lịch"}, {en: "cave", vi: "hang động"},
        {en: "by boat", vi: "bằng thuyền"}, {en: "extremely", vi: "cực kỳ"}, {en: "mountain", vi: "núi"},
        {en: "look", vi: "trông, nhìn"}, {en: "stunning", vi: "ấn tượng, rất đẹp"}, {en: "sunrise", vi: "bình minh"},
        {en: "peaceful", vi: "yên bình"}, {en: "green", vi: "xanh"}, {en: "experience", vi: "trải nghiệm"},
        {en: "scientist", vi: "nhà khoa học"}, {en: "carry out", vi: "tiến hành"}, {en: "deep", vi: "sâu"},
        {en: "ocean", vi: "đại dương"}, {en: "old town", vi: "khu phố cổ"}, {en: "attract", vi: "thu hút"},
        {en: "visitor", vi: "du khách"}, {en: "view", vi: "quang cảnh"}, {en: "top", vi: "đỉnh"},
        {en: "amaze", vi: "làm kinh ngạc"}, {en: "waterfall", vi: "thác nước"}, {en: "children", vi: "trẻ em"},
        {en: "develop", vi: "phát triển"}, {en: "sustainable", vi: "bền vững"}, {en: "destroy", vi: "phá hủy"},
        {en: "environment", vi: "môi trường"}, {en: "environmentalist", vi: "nhà bảo vệ môi trường"},
        {en: "protect", vi: "bảo vệ"}, {en: "country", vi: "quốc gia"}, {en: "face", vi: "đối mặt"},
        {en: "illegal logging", vi: "chặt phá rừng trái phép"}, {en: "rainforest", vi: "rừng mưa"},
        {en: "climate change", vi: "biến đổi khí hậu"}, {en: "eco-friendly", vi: "thân thiện môi trường"},
        {en: "discover", vi: "phát hiện"}, {en: "contribute", vi: "đóng góp"}, {en: "risky", vi: "mạo hiểm"},
        {en: "heritage", vi: "di sản"}, {en: "paradise", vi: "thiên đường"}, {en: "urgent", vi: "khẩn cấp"},
        {en: "government", vi: "chính phủ"}, {en: "national park", vi: "công viên quốc gia"}
    ];

    // Dữ liệu trắc nghiệm
    const mcQuestions = [
        { q: "Ha Long Bay is considered a natural _________ of the world.", options: ["contest", "charm", "wonder", "discovery"], correct: 2, trans: ["cuộc thi", "sự quyến rũ", "kỳ quan", "khám phá"] },
        { q: "The tourists came to _________ the rainforest and learn about its biodiversity.", options: ["access", "develop", "destroy", "explore"], correct: 3, trans: ["truy cập", "phát triển", "phá hủy", "khám phá"] },
        { q: "Their recent _________ led to the discovery of a new waterfall.", options: ["exploration", "development", "protection", "encouragement"], correct: 0, trans: ["thám hiểm", "phát triển", "bảo vệ", "khuyến khích"] },
        { q: "The rocky _________ in this area is admired by all visitors.", options: ["valley", "landscape", "environment", "access"], correct: 1, trans: ["thung lũng", "phong cảnh", "môi trường", "lối vào"] },
        { q: "We need to _________ efforts to protect endangered species.", options: ["rank", "support", "locate", "admire"], correct: 1, trans: ["xếp hạng", "hỗ trợ", "định vị", "ngưỡng mộ"] },
        { q: "A _________ tourism plan helps protect natural wonders.", options: ["sustainable", "risky", "urgent", "virtual"], correct: 0, trans: ["bền vững", "rủi ro", "khẩn cấp", "ảo"] },
        { q: "The mountain was _________ by illegal logging.", options: ["destroyed", "discovered", "supported", "located"], correct: 0, trans: ["phá hủy", "phát hiện", "hỗ trợ", "định vị"] },
        { q: "The Grand Canyon is a truly _________ sight.", options: ["virtual", "risky", "magnificent", "admirable"], correct: 2, trans: ["ảo", "rủi ro", "tráng lệ", "ngưỡng mộ"] },
        { q: "The beauty of the coral reef left us full of _________.", options: ["permission", "contest", "wonder", "urgency"], correct: 2, trans: ["cho phép", "cuộc thi", "kinh ngạc", "khẩn cấp"] },
        { q: "She was one of the youngest _________ in the national nature photo contest.", options: ["contestants", "protectors", "supporters", "environmentalists"], correct: 0, trans: ["thí sinh", "người bảo vệ", "người hỗ trợ", "nhà môi trường"] }
    ];

    // Khởi tạo trắc nghiệm
    const mcContainer = document.getElementById('mcContainer');
    mcQuestions.forEach((item, idx) => {
        let optionsHTML = item.options.map((opt, i) => 
            `<div class="option-item" onclick="selectMC(${idx}, ${i})" id="opt-${idx}-${i}">${String.fromCharCode(65+i)}. ${opt}</div>`
        ).join('');
        
        mcContainer.innerHTML += `
            <div class="question-block" id="qblock-${idx}">
                <p><b>Q${idx+1}:</b> ${item.q}</p>
                <div class="options">${optionsHTML}</div>
                <div class="feedback" id="feed-${idx}"><b>Nghĩa:</b> A: ${item.trans[0]} | B: ${item.trans[1]} | C: ${item.trans[2]} | D: ${item.trans[3]}</div>
            </div>`;
    });

    let mcAnswers = {};
    function selectMC(qIdx, oIdx) {
        mcAnswers[qIdx] = oIdx;
        document.querySelectorAll(`#qblock-${qIdx} .option-item`).forEach(el => el.classList.remove('selected'));
        document.getElementById(`opt-${qIdx}-${oIdx}`).classList.add('selected');
    }

    // Kéo thả logic
    let draggedItem = null;
    document.querySelectorAll('.draggable').forEach(item => {
        item.addEventListener('dragstart', function() { draggedItem = this; });
    });
    document.querySelectorAll('.drop-zone').forEach(zone => {
        zone.addEventListener('dragover', e => e.preventDefault());
        zone.addEventListener('drop', function() {
            if(draggedItem) this.textContent = draggedItem.textContent;
        });
    });

    // Từ điển logic
    function toggleDict() {
        document.getElementById('dictionary-panel').classList.toggle('open');
        if(document.getElementById('dictionary-panel').classList.contains('open')) renderDict(dictionary);
    }
    function renderDict(data) {
        const list = document.getElementById('dictList');
        list.innerHTML = data.map(i => `<div class="dict-item"><span class="dict-word">${i.en}</span>: ${i.vi}</div>`).join('');
    }
    function searchDict() {
        const term = document.getElementById('dictSearch').value.toLowerCase();
        const filtered = dictionary.filter(i => i.en.toLowerCase().includes(term) || i.vi.toLowerCase().includes(term));
        renderDict(filtered);
    }

    // Nộp bài
    function submitQuiz() {
        const name = document.getElementById('studentName').value;
        if(!name) { alert("Em hãy nhập tên trước khi nộp nhé!"); return; }

        let score = 0;
        // Chấm kéo thả
        document.querySelectorAll('.drop-zone').forEach(zone => {
            const isCorrect = zone.textContent.trim() === zone.dataset.ans;
            zone.className = isCorrect ? 'drop-zone correct-ans' : 'drop-zone wrong-ans';
            if(isCorrect) score++;
            else zone.innerHTML += ` (${zone.dataset.ans})`;
        });

        // Chấm trắc nghiệm
        mcQuestions.forEach((item, idx) => {
            document.getElementById(`feed-${idx}`).style.display = 'block';
            const correctOpt = document.getElementById(`opt-${idx}-${item.correct}`);
            if(mcAnswers[idx] === item.correct) {
                score++;
                correctOpt.classList.add('correct-ans');
            } else if(mcAnswers[idx] !== undefined) {
                document.getElementById(`opt-${idx}-${mcAnswers[idx]}`).classList.add('wrong-ans');
                correctOpt.classList.add('correct-ans');
            } else {
                correctOpt.classList.add('correct-ans');
            }
        });

        alert(`Chúc mừng ${name}! Em đã hoàn thành bài tập. Điểm số đã được lưu.`);
        saveResult(name, score);
        document.getElementById('submit-btn').disabled = true;
    }

    function saveResult(name, score) {
        let results = JSON.parse(localStorage.getItem('studentResults') || '[]');
        results.push({name, score: score + "/40", time: new Date().toLocaleString()});
        localStorage.setItem('studentResults', JSON.stringify(results));
    }

    function toggleAdmin() {
        const panel = document.getElementById('admin-panel');
        panel.style.display = (panel.style.display === 'block') ? 'none' : 'block';
        const tbody = document.getElementById('adminRecords');
        const results = JSON.parse(localStorage.getItem('studentResults') || '[]');
        tbody.innerHTML = results.map(r => `<tr><td>${r.name}</td><td>${r.score}</td><td>${r.time}</td></tr>`).join('');
    }
</script>

</body>
</html>